@Override
public void onTestFailure(ITestResult result) {
    extentTest.get().log(Status.FAIL, "Test Failed: " + result.getThrowable().getMessage());
    try {
        String screenshotBase64 = CaptureScreenshot.captureAsBase64(result.getMethod().getMethodName());
        extentTest.get().addScreenCaptureFromBase64String(screenshotBase64, "Screenshot on Failure");
    } catch (IOException e) {
        extentTest.get().log(Status.FAIL, "Screenshot capture failed: " + e.getMessage());
    }
}